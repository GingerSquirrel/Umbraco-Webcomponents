# Web Components Vite Project

A project which aims to to build webcomponents in Umbraco in the most efficient way possible, using TypeScript, SCSS and Umbraco specific build configurations.

---

## 📁 Project Structure

```
webcomponents-vite-project
├── src
│   ├── index.html                  # Main HTML file
│   ├── main.ts                     # Main TypeScript entry
│   └── components
│       └── ...                     # Add components here
├── package.json                    # npm configuration and scripts
├── vite.config.js                  # Vite configuration
└── README.md                       # Project documentation
```

---

## 🚀 Getting Started

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd webcomponents-vite-project
   ```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Start the development server**
   ```bash
   npm run dev
   ```
   Open [https://localhost:3000](https://localhost:3000) in your browser.

4. **Build for production**
   ```bash
   npm run build
   ```

---

## 🛠️ Development Tools

### Service Worker Toggle

The project includes a development tools panel that appears in the top-right corner during development mode. This allows you to:

- **Toggle Service Worker**: Enable/disable the service worker without code changes
- **Clear Cache**: Remove all cached data for testing
- **Hard Reload**: Force a complete page refresh

You can also disable the service worker via environment variables:

```bash
# Create .env file in frontend directory
echo "VITE_DISABLE_SW=true" > .env
```

For more details, see [SERVICE-WORKER-TOGGLE.md](./SERVICE-WORKER-TOGGLE.md).

---

## 🔒 SSL Certificate Setup for Local Development

This project uses HTTPS for local development to ensure proper testing of secure features like service workers. Follow these steps to set up trusted SSL certificates:

### Prerequisites

- **Windows**: Install [Chocolatey](https://chocolatey.org/install) or [Scoop](https://scoop.sh/)
- **macOS**: Install [Homebrew](https://brew.sh/)
- **Linux**: Install via your package manager

### Step 1: Install mkcert

Choose your platform and run the appropriate command:

**Windows (Chocolatey):**
```powershell
choco install mkcert
```

**Windows (Scoop):**
```powershell
scoop bucket add extras
scoop install mkcert
```

**macOS:**
```bash
brew install mkcert
```

**Linux (Ubuntu/Debian):**
```bash
sudo apt install libnss3-tools
curl -JLO "https://dl.filippo.io/mkcert/latest?for=linux/amd64"
chmod +x mkcert-v*-linux-amd64
sudo cp mkcert-v*-linux-amd64 /usr/local/bin/mkcert
```

### Step 2: Install the Certificate Authority

Run this command to install mkcert's root certificate in your system's trust store:

```bash
mkcert -install
```

This step is crucial - it tells your system to trust certificates generated by mkcert.

### Step 3: Generate Local Certificates

Navigate to the frontend directory and create certificates for localhost:

```bash
cd frontend/certs
mkcert localhost 127.0.0.1 ::1
```

This creates two files:
- `localhost+2.pem` (certificate)
- `localhost+2-key.pem` (private key)

### Step 4: Update Vite Configuration

The `vite.config.js` is already configured to use these certificates:

```javascript
server: {
  port: 3000,
  host: true,
  https: {
    key: fs.readFileSync(path.resolve(__dirname, 'certs/localhost+2-key.pem')),
    cert: fs.readFileSync(path.resolve(__dirname, 'certs/localhost+2.pem'))
  }
}
```

### Step 5: Restart Development Server

After generating new certificates, restart your development server:

```bash
npm run dev
```

### Troubleshooting

**Still seeing "Connection is not private"?**

1. **Restart your browser completely** - Close all browser windows and restart
2. **Clear browser cache** for localhost - Go to browser settings and clear site data for localhost:3000
3. **Hard refresh** - Try Ctrl+Shift+R (Windows/Linux) or Cmd+Shift+R (macOS)
4. **Check certificate installation** - Run `mkcert -install` again to ensure the CA is properly installed

**Certificate conflicts?**

If you have both `@vitejs/plugin-basic-ssl` and manual HTTPS configuration, remove the plugin to avoid conflicts:

```javascript
// Remove this from vite.config.js plugins array
// basicSsl()
```

**For Chrome/Edge users:**

You can also start Chrome with flags to ignore certificate errors during development:

```bash
chrome.exe --ignore-certificate-errors --ignore-ssl-errors --allow-running-insecure-content --disable-web-security --allow-insecure-localhost
```

### Security Notes

- These certificates are only for **local development**
- Never use mkcert certificates in production
- The certificates expire in 2 years and can be regenerated as needed
- Keep your `certs/` directory in `.gitignore` to avoid committing private keys

---

## � Progressive Web App (PWA)

This project is configured as a PWA with offline support, installability, and optimized caching.

### PWA Features

- **📦 App Shell Caching**: Core files (HTML, JS, CSS) cached for instant loading
- **🔤 Google Fonts Caching**: Inter font family cached for offline use
- **🖼️ Asset Caching**: Images, icons, and SVGs cached intelligently
- **📱 Installable**: Can be installed on mobile and desktop devices
- **⚡ Offline Support**: Works without internet connection
- **🔄 Background Updates**: New versions download automatically

### Installing the PWA

#### On Desktop (Chrome/Edge):
1. Visit the app in your browser
2. Look for the install icon (⬇️) in the address bar
3. Click "Install App" button that appears on the page
4. Choose "Install" in the browser prompt

#### On Mobile:
1. Open the app in Chrome/Safari
2. Tap the share button
3. Select "Add to Home Screen"
4. The app will appear as a native app icon

### Service Worker Caching Strategy

The service worker uses a multi-tier caching approach:

#### Static Cache (`static-v1`)
- Core app files (HTML, manifest, PWA icons)
- **Web components bundle** (all TypeScript components compiled to JS)
- **Google Fonts** (Inter font family)
- Critical CSS files

#### Dynamic Cache (`dynamic-v1`)
- Component images and SVGs
- Other fonts and assets
- Cached on first request

#### Google Fonts Caching
The service worker specifically handles Google Fonts from `fonts.gstatic.com`:

```javascript
// Cached Google Fonts:
- Inter (latin-ext): UcCo3FwrK3iLTcvsYwYL8g.woff2
- Inter (latin): UcCo3FwrK3iLTcviYwY.woff2
```

**Benefits:**
- ⚡ **Instant font loading** - No FOUT (Flash of Unstyled Text)
- 🔌 **Offline typography** - Fonts work without internet
- 🚀 **Performance** - No external font requests after first load

### Testing PWA Features

1. **Cache Inspection**:
   - Open DevTools (F12) → Application → Cache Storage
   - Check `static-v1` and `dynamic-v1` caches

2. **Offline Testing**:
   - DevTools → Network → Check "Offline"
   - Refresh the page - should load instantly from cache

3. **Install Prompt**:
   - Look for install button on the page
   - Check for browser install prompt

---

## �🛠 Usage

- The main entry point is `src/index.html`, which loads your main script.
- Add or modify components in the `src/components` directory.
- Import and register your custom elements in `main.ts` and add them to `main.scss`.

---

## 🎨 Design Reference

This project is inspired by a [Figma minimal landing page design](https://www.figma.com/community/file/1222060007934600841/minimal-landing-page-design-website-home-page-design-agency-website-ui-design).

---

## 📚 Notes

- You can use SCSS for global and component-specific styles.
- Vite enables fast hot module replacement and modern build tooling.
- Extend this setup to add more components or integrate with frameworks as needed.

## DEMO
[See here](https://black-water-04dcb7f1e.2.azurestaticapps.net/)